---
alwaysApply: true
---

# Changelog Best Practices

## General Principles

- Changelogs are for humans, not machines.
- Include an entry for every version, with the latest first.
- Group similar changes under: Added, Changed, Improved, Deprecated, Removed, Fixed, Documentation, Performance, CI.
- **"Test" is NOT a valid changelog category** - tests should be mentioned within the related feature or fix entry, not as standalone entries.
- Use an "Unreleased" section for upcoming changes.
- Follow Semantic Versioning where possible.
- Use ISO 8601 date format: YYYY-MM-DD.
- Avoid dumping raw git logs; summarize notable changes clearly.

## Release Process

**IMPORTANT: All releases must follow the steps documented in `CONTRIBUTING.md`.**

**CRITICAL: Releases must be prepared on the `main` branch.** Before starting the release process, ensure you are on the `main` branch and that it is up to date with the remote:

```bash
git checkout main
git pull origin main
```

Before preparing a release, refer to the "Releasing _(For Maintainers)_" section in `CONTRIBUTING.md` for the complete release process. The release process includes:

1. **Ensuring you're on the `main` branch** - Releases must be prepared from `main`, not from feature branches
2. Checking `TODO.md` for critical items
3. Updating `CHANGELOG.md` with the new release version and changes
4. Bumping version numbers using `bump2version` (or manually updating `pyproject.toml` and `README.md`)
5. Verifying changes and pushing
6. Tagging the release
7. CI/CD will automatically handle PyPI publishing

**Do not skip any steps in the release process.** See `CONTRIBUTING.md` for detailed instructions.

## Test Coverage in Changelog

**Tests should NOT be listed separately in the "Added" section.**

Tests are implementation details that support features or fixes. They should be mentioned within the related feature or fix entry, not as standalone entries.

### ❌ WRONG - Separate test entry:

```markdown
### Fixed

- **Bug Fix**: Fixed issue with metadata parsing

### Added

- **Tests**: Added comprehensive unit tests for metadata parsing
```

### ✅ CORRECT - Tests mentioned with the feature/fix:

```markdown
### Fixed

- **Bug Fix**: Fixed issue with metadata parsing
  - Includes comprehensive unit tests covering edge cases and error scenarios
```

### ✅ CORRECT - Tests mentioned inline:

```markdown
### Fixed

- **Mutagen Exception Handling**: Added comprehensive exception handling for mutagen operations:
  - Created `_handle_mutagen_exception()` helper function to centralize exception handling
  - Includes comprehensive unit tests (21 test cases) covering all exception handling scenarios
```

## Documentation Entries

**Documentation changes should be listed in the "Documentation" section, not "Added" or "Improved".**

Documentation-only changes (new guides, documentation updates, README changes, etc.) should be categorized under "Documentation" to clearly distinguish them from code changes.

### ✅ CORRECT - Documentation in Documentation section:

```markdown
### Documentation

- **Metadata Formats Guide**: Added comprehensive `METADATA_FORMATS.md` guide documenting all supported metadata formats
- **Metadata Field Guide**: Enhanced `METADATA_FIELD_GUIDE.md` with BWF field support
```

### ❌ WRONG - Documentation in Added section:

```markdown
### Added

- **Metadata Formats Guide**: Added comprehensive `METADATA_FORMATS.md` guide
```

### When to Use Documentation Section

- New documentation files (guides, tutorials, API docs)
- Updates to existing documentation
- README changes
- Documentation structure improvements
- Clarifications and corrections to documentation

### When NOT to Use Documentation Section

- Code changes that happen to include documentation updates (use "Added", "Fixed", etc.)
- Docstring updates that are part of code changes (mention in the code change entry)

## When to Mention Tests

- **Mention tests** when they provide important context about the change (e.g., "includes tests covering edge cases")
- **Don't create separate entries** for tests unless they represent a significant testing infrastructure improvement (e.g., new test framework, new test utilities)
- **Test infrastructure changes** (new test helpers, test framework updates) can be mentioned in "Improved" or "Added" sections, but test coverage for features/fixes should be mentioned with the feature/fix

## Examples

### Feature with Tests

```markdown
### Added

- **New Feature**: Added support for FLAC metadata reading
  - Includes comprehensive unit tests covering various metadata formats
  - Includes integration tests verifying compatibility with external tools
```

### Bug Fix with Tests

```markdown
### Fixed

- **Metadata Parsing**: Fixed issue with parsing ID3v2 tags containing special characters
  - Includes regression tests to prevent future occurrences
```

### Test Infrastructure (Can be separate)

```markdown
### Improved

- **Test Infrastructure**: Added new test helper utilities for creating temporary audio files
  - Simplifies test setup and improves test maintainability
```
