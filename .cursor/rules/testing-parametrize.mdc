---
alwaysApply: true
---

# Using pytest.mark.parametrize in Tests

## When to Use parametrize

Use `@pytest.mark.parametrize` to test the **same validation or behavior with multiple input values**. This makes tests:
- More readable and maintainable
- Easier to identify which specific value causes a failure
- Reduces code duplication from multiple function calls or for loops

## ❌ WRONG - Multiple separate calls or for loops:

```python
def test_valid_track_number_as_int(self):
    validate_unified_metadata_values_before_update({UnifiedMetadataKey.TRACK_NUMBER: 1})
    validate_unified_metadata_values_before_update({UnifiedMetadataKey.TRACK_NUMBER: 5})
    validate_unified_metadata_values_before_update({UnifiedMetadataKey.TRACK_NUMBER: 99})

def test_invalid_rating_type_raises_error(self):
    with pytest.raises(InvalidMetadataFieldTypeError):
        validate_unified_metadata_values_before_update({UnifiedMetadataKey.RATING: "invalid"})

    with pytest.raises(InvalidMetadataFieldTypeError):
        validate_unified_metadata_values_before_update({UnifiedMetadataKey.RATING: {}})
```

## ✅ CORRECT - Use parametrize:

```python
@pytest.mark.parametrize(
    "track_number",
    [1, 5, 99],
)
def test_valid_track_number_as_int(self, track_number):
    validate_unified_metadata_values_before_update({UnifiedMetadataKey.TRACK_NUMBER: track_number})

@pytest.mark.parametrize(
    "invalid_value",
    ["invalid", {}],
)
def test_invalid_rating_type_raises_error(self, invalid_value):
    with pytest.raises(InvalidMetadataFieldTypeError):
        validate_unified_metadata_values_before_update({UnifiedMetadataKey.RATING: invalid_value})
```

## When NOT to Use parametrize

- When testing a **single specific case** - use a regular test method
- When different cases require **significantly different logic** - use separate test methods with descriptive names
- When the parameter represents a **complex scenario** requiring substantial setup - consider separate methods for clarity
