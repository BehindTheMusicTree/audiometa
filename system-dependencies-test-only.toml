# Test-Only Dependencies Configuration
# This file documents TEST-ONLY system dependencies required for running tests.
# These are supplementary dependencies only needed for test verification/setup, not for library functionality.
# NOTE: Tests also require PROD dependencies (ffmpeg, flac, id3v2) - see system-dependencies-prod.toml
# For a complete test environment, you need both PROD and TEST-ONLY dependencies.
# - mediainfo: Used in test helpers for verification
# - exiftool: Used in test helpers for verification
# - bwfmetaedit: Used in test helpers for RIFF metadata setup
# - libsndfile: Required by soundfile Python package (used only in tests)
#
# Version pinning strategy:
# - ALWAYS pin specific versions (e.g., "1.2.3") - NEVER use "latest"
# - Exception: libsndfile1 uses "latest" because it's a transitive dependency managed by Ubuntu's package manager
# - For Ubuntu: versions are Ubuntu release-specific (check with: apt-cache policy <package>)
# - For macOS: Homebrew versions can be pinned using @version syntax
# - For Windows: Chocolatey supports --version flag

[ubuntu]
# TEST dependencies (only needed for test verification/setup)
# Ubuntu package versions (install via apt-get)
mediainfo = "24.01"
libimage-exiftool-perl = "12.76+dfsg-1"  # Provides exiftool command
bwfmetaedit = { source = "repos_or_mediaarea", pinned_version = "25.04.1" }  # Used in test helpers for RIFF metadata setup
# libsndfile1: Library dependency (not executable tool) required by soundfile Python package.
# Used only in tests (soundfile is in dev dependencies, not production dependencies).
# Uses "latest" because: (1) it's a transitive dependency managed by Ubuntu's package manager,
# (2) it doesn't have a version command to verify, (3) version is tied to Ubuntu release and
# Ubuntu provides compatible versions automatically. This is an exception to the version pinning policy.
libsndfile1 = "latest"  # TEST dependency - required by soundfile (used only in tests)

[macos]
# TEST dependencies (only needed for test verification/setup)
# macOS packages are installed via Homebrew
# Note: mediainfo (media-info in Homebrew) cannot be pinned - Homebrew installs whatever version
# is currently in the formula. If CI fails with version mismatch, update this pinned version to
# match what Homebrew currently provides (check with: brew info media-info).
mediainfo = "25.10"
exiftool = { source = "exiftool_org", pinned_version = "13.42" }
bwfmetaedit = "25.04.1"  # Used in test helpers for RIFF metadata setup
libsndfile = "1.2.2"  # TEST dependency - required by soundfile (used only in tests)

[windows]
# TEST dependencies (only needed for test verification/setup)
# Windows package versions (install via Chocolatey)
# mediainfo: Only needed for integration tests (verification), not e2e tests
# Skipped in Windows CI since we only run e2e tests on Windows
# Still installed locally for full test coverage
mediainfo = "24.12"
bwfmetaedit = { source = "mediaarea", pinned_version = "24.10" }  # Used in test helpers for RIFF metadata setup
# exiftool: Download from official website (not available in Chocolatey)
# Note: Windows version may differ from macOS/Linux due to release availability
# Check https://exiftool.org/ for available Windows versions
# Pinned to latest available version (fetched from https://exiftool.org/ver.txt)
# OPTIONAL in Windows CI: Not used in e2e tests, skipped in Windows CI
exiftool = { source = "exiftool_org", pinned_version = "13.42" }

